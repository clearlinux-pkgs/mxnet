#
# This file is auto-generated. DO NOT EDIT
# Generated by: autospec.py
#
Name     : mxnet
Version  : 1.4.0.rc0
Release  : 8
URL      : https://github.com/apache/incubator-mxnet/releases/download/1.4.0.rc0/apache-mxnet-src-1.4.0.rc0-incubating.tar.gz
Source0  : https://github.com/apache/incubator-mxnet/releases/download/1.4.0.rc0/apache-mxnet-src-1.4.0.rc0-incubating.tar.gz
Summary  : 'Perl interface to MXNet Gluon ModelZoo'
Group    : Development/Tools
License  : Apache-2.0 BSD-2-Clause BSD-3-Clause BSD-3-Clause-LBNL MIT NCSA
Requires: PyYAML
Requires: decorator
Requires: docker
Requires: h5py
Requires: mxnet
Requires: nose
Requires: numpy
Requires: onnx
Requires: pylint
Requires: python-graphviz
Requires: requests
Requires: scipy
BuildRequires : PyYAML
BuildRequires : Vulkan-Headers-dev Vulkan-Loader-dev Vulkan-Tools
BuildRequires : apache-spark
BuildRequires : beignet-dev
BuildRequires : boost-dev
BuildRequires : buildreq-cmake
BuildRequires : buildreq-cpan
BuildRequires : buildreq-distutils3
BuildRequires : cmake
BuildRequires : curl-dev
BuildRequires : decorator
BuildRequires : dmlc-core-dev
BuildRequires : doxygen
BuildRequires : git
BuildRequires : glibc-dev
BuildRequires : googletest-dev
BuildRequires : hwloc-dev
BuildRequires : mesa-dev
BuildRequires : numpy
BuildRequires : onnx
BuildRequires : openblas
BuildRequires : openjdk9-dev
BuildRequires : openssl-dev
BuildRequires : perl
BuildRequires : pkg-config
BuildRequires : pkgconfig(jemalloc)
BuildRequires : pkgconfig(libffi)
BuildRequires : protobuf-dev
BuildRequires : python-graphviz
BuildRequires : python3
BuildRequires : python3-dev
Patch1: 0002-Use-system-dmlc-core.patch

%description
The Google Mock class generator is an application that is part of cppclean.
visit http://code.google.com/p/cppclean/

%prep
%setup -q -n apache-mxnet-src-1.4.0.rc0-incubating
%patch1 -p1

%build
export http_proxy=http://127.0.0.1:9/
export https_proxy=http://127.0.0.1:9/
export no_proxy=localhost,127.0.0.1,0.0.0.0
export LANG=C
export SOURCE_DATE_EPOCH=1545605993
mkdir -p clr-build
pushd clr-build
%cmake .. -DUSE_CUDA=OFF -DUSE_MKLDNN=0 -DUSE_BLAS=openblas
make  %{?_smp_mflags}
popd

%install
export SOURCE_DATE_EPOCH=1545605993
rm -rf %{buildroot}
mkdir -p %{buildroot}/usr/share/package-licenses/mxnet
cp 3rdparty/ctc_include/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_ctc_include_LICENSE
cp 3rdparty/ctc_include/contrib/moderngpu/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_ctc_include_contrib_moderngpu_LICENSE
cp 3rdparty/cub/LICENSE.TXT %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_cub_LICENSE.TXT
cp 3rdparty/dlpack/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_dlpack_LICENSE
cp 3rdparty/dmlc-core/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_dmlc-core_LICENSE
cp 3rdparty/googletest/googlemock/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_googletest_googlemock_LICENSE
cp 3rdparty/googletest/googlemock/scripts/generator/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_googletest_googlemock_scripts_generator_LICENSE
cp 3rdparty/googletest/googletest/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_googletest_googletest_LICENSE
cp 3rdparty/mkldnn/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_mkldnn_LICENSE
cp 3rdparty/mkldnn/src/cpu/xbyak/COPYRIGHT %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_mkldnn_src_cpu_xbyak_COPYRIGHT
cp 3rdparty/mkldnn/tests/gtests/gtest/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_mkldnn_tests_gtests_gtest_LICENSE
cp 3rdparty/mshadow/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_mshadow_LICENSE
cp 3rdparty/onnx-tensorrt/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_onnx-tensorrt_LICENSE
cp 3rdparty/onnx-tensorrt/third_party/onnx/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_onnx-tensorrt_third_party_onnx_LICENSE
cp 3rdparty/onnx-tensorrt/third_party/onnx/third_party/benchmark/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_onnx-tensorrt_third_party_onnx_third_party_benchmark_LICENSE
cp 3rdparty/onnx-tensorrt/third_party/onnx/third_party/pybind11/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_onnx-tensorrt_third_party_onnx_third_party_pybind11_LICENSE
cp 3rdparty/onnx-tensorrt/third_party/onnx/third_party/pybind11/tools/clang/LICENSE.TXT %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_onnx-tensorrt_third_party_onnx_third_party_pybind11_tools_clang_LICENSE.TXT
cp 3rdparty/openmp/LICENSE.txt %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_openmp_LICENSE.txt
cp 3rdparty/ps-lite/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_ps-lite_LICENSE
cp 3rdparty/tvm/3rdparty/HalideIR/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_tvm_3rdparty_HalideIR_LICENSE
cp 3rdparty/tvm/3rdparty/dlpack/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_tvm_3rdparty_dlpack_LICENSE
cp 3rdparty/tvm/3rdparty/dmlc-core/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_tvm_3rdparty_dmlc-core_LICENSE
cp 3rdparty/tvm/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/3rdparty_tvm_LICENSE
cp NOTICE %{buildroot}/usr/share/package-licenses/mxnet/NOTICE
cp contrib/clojure-package/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/contrib_clojure-package_LICENSE
cp cpp-package/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/cpp-package_LICENSE
cp docker/Dockerfiles/License.md %{buildroot}/usr/share/package-licenses/mxnet/docker_Dockerfiles_License.md
cp example/gluon/tree_lstm/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/example_gluon_tree_lstm_LICENSE
cp example/rcnn/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/example_rcnn_LICENSE
cp julia/LICENSE.md %{buildroot}/usr/share/package-licenses/mxnet/julia_LICENSE.md
cp python/mxnet/contrib/onnx/mx2onnx/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/python_mxnet_contrib_onnx_mx2onnx_LICENSE
cp scala-package/LICENSE %{buildroot}/usr/share/package-licenses/mxnet/scala-package_LICENSE
pushd clr-build
%make_install
popd
## install_append content
pushd python
eu-strip $(pwd)/../clr-build/libmxnet.so
MXNET_LIBRARY_PATH=$(pwd)/../clr-build/libmxnet.so python3 -tt setup.py build install --root=%{buildroot}
popd
## install_append end

%files
%defattr(-,root,root,-)
